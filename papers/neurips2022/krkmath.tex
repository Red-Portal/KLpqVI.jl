
\usepackage{amsmath,amssymb,amsthm}
\usepackage{mathtools}

\usepackage{fontspec}
%\usepackage{fouriernc}
\usepackage{unicode-math}
\setmathfont{STIXTwoMath-Regular.otf}
\setmainfont[
         BoldFont={STIXTwoText-Bold.otf}, 
         ItalicFont={STIXTwoText-Italic.otf},
         BoldItalicFont={STIXTwoText-BoldItalic.otf}
         ]{STIXTwoText-Regular.otf}

%\setmainfont{Times New Roman}
%\setmathfont{Erewhon-Math.otf}

%\setmainfont{TeX Gyre Schola}[Scale=0.90] % Text
% Math: mix of Erewhon and Schola
%\setmathfont{Erewhon-Math.otf}
% \setmathfont{TeX Gyre Schola Math}[Scale=0.93,
%%     range={up/{latin,Latin,num}, it/{latin,Latin,num},
%%            bfup/{latin,Latin,num}, bfit{latin,Latin,num}}]

\usepackage{booktabs,threeparttable,arydshln}
\usepackage{multirow}
\usepackage{nicematrix}

\usepackage{dsfont}
\usepackage[algo2e, ruled]{algorithm2e}

\usepackage{pgfplots}
\pgfkeys{/pgfplots/tuftelike/.style={
  semithick,
  tick style={major tick length=4pt,semithick,black},
  separate axis lines,
  axis x line*=bottom,
  axis x line shift=2pt,
  xlabel shift=-2pt,
  axis y line*=left,
  axis y line shift=2pt,
  ylabel shift=-2pt}}
  
\usepackage{proof-at-the-end}
\declaretheoremstyle[
    spaceabove=0\topsep,
    spacebelow=0\topsep,
    name={Proposition},
]{propsty}
\declaretheorem[style=propsty]{proposition}

\declaretheoremstyle[
    spaceabove=0\topsep,
    spacebelow=0\topsep,
    name={Theorem},
]{thmsty}
\declaretheorem[style=thmsty]{theorem}

\newtheorem{remark}{\textbf{Remark}}
\newtheorem{lemma}{\textbf{Lemma}}
\newtheorem{assumption}{\textbf{Assumption}}
\newtheorem{condition}{\textbf{Condition}}
%\newtheorem{theorem}{\textbf{Theorem}}
%\newtheorem{proposition}{\textbf{Proposition}}
\newtheorem{definition}{\textbf{Definition}}

\usepackage{mdframed}
\newmdtheoremenv{framedtheorem}{\textbf{Theorem}}
\newmdtheoremenv{framedproposition}{\textbf{Proposition}}
\newmdtheoremenv{framedlemma}{\textbf{Lemma}}


\usepackage{url}
\usepackage{hyperref}
\usepackage[noabbrev, capitalise, nameinlink]{cleveref}


\crefname{assumption}{Assumption}{Assumption}
\crefname{condition}{Condition}{Condition}

\crefname{framedtheorem}{Theorem}{Theorems}
\crefname{framedproposition}{Proposition}{Propositions}
\crefname{framedlemma}{Lemma}{Lemmas}

\makeatletter
\def\adl@drawiv#1#2#3{%
        \hskip.5\tabcolsep
        \xleaders#3{#2.5\@tempdimb #1{1}#2.5\@tempdimb}%
                #2\z@ plus1fil minus1fil\relax
        \hskip.5\tabcolsep}
\newcommand{\cdashlinelr}[1]{%
  \noalign{\vskip\aboverulesep
           \global\let\@dashdrawstore\adl@draw
           \global\let\adl@draw\adl@drawiv}
  \cdashline{#1}
  \noalign{\global\let\adl@draw\@dashdrawstore
           \vskip\belowrulesep}}
\makeatother

%% \newcommand*{\figref}[2][]{%
%%   \hyperref[{#2}]{%
%%     Figure~\ref*{#2}%
%%     \ifx\\#1\\%
%%     \else
%%       \,#1%
%%     \fi
%%   }%
%% }

\pgfkeys{/prAtEnd/global custom defaults/.style={
    %proof at the end,
    end,
    %normal,
    restate,
    %% text link={\textit{Proof.} See page~\pageref{proof:prAtEnd\pratendcountercurrent} of the \textit{supplementary material}.},
    %text link={\textit{Proof.} The proof is in the \textit{supplementary material}.
    text proof={Proof},
    text link={\textit{Proof.} See the \hyperref[proof:prAtEnd\pratendcountercurrent]{\textit{full proof}} in page~\pageref{proof:prAtEnd\pratendcountercurrent}.}
  }
}

\def\code#1{\texttt{#1}}
\DeclareMathOperator*{\minimize}{minimize}
\DeclareMathOperator*{\maximize}{maximize}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min} 

\newcommand*\xbar[1]{%
  \hbox{%
    \vbox{%
      \hrule height 0.6pt % The actual bar
      \kern0.33ex%         % Distance between bar and symbol
      \hbox{%
        \kern-0.1em%      % Shortening on the left side
        \ensuremath{#1}%
        \kern-0.1em%      % Shortening on the right side
      }%
    }%
  }%
} 

\newcommand{\E}[1]{\mathbb{E}\left[\,#1\,\right]}
\newcommand{\Esub}[2]{\mathbb{E}_{#1}\left[\,#2\,\right]}
\newcommand{\V}[1]{\mathbb{V}\left[\,#1\,\right]}
\newcommand{\Vsub}[2]{\mathbb{V}_{#1}\left[\,#2\,\right]}
\newcommand{\Cov}[1]{\mathrm{Cov}\left(\,#1\,\right)}
\newcommand{\Covsub}[2]{\mathrm{Cov}_{#1}\left(\,#2\,\right)}
\newcommand{\Corr}[1]{\mathrm{Corr}\left(\,#1\,\right)}

\newcommand{\Df}[2]{d_{f}(#1\parallel#2)}
\newcommand{\DKL}[2]{d_{\mathrm{KL}}(#1\parallel#2)}
\newcommand{\DChi}[2]{d_{\chi^2}(#1\parallel#2)}
\newcommand{\norm}[1]{{\left\lVert\,#1\,\right\rVert}}
\newcommand{\abs}[1]{{\left|\,#1\,\right|}}
\newcommand{\DTV}[2]{{d_{\mathrm{TV}}\left(#1, #2\right)}}

%\DeclarePairedDelimiter\norm{\lVert}{\rVert}
%\newcommand{\symbfup}[1]{\mathbf{#1}}
%\newcommand{\symbf}[1]{\mathbf{#1}}

\newcommand{\vX}{\symbfup{X}}
\newcommand{\vY}{\symbfup{Y}}
\newcommand{\vZ}{\symbfup{Z}}

\newcommand{\va}{\symbfup{a}}
\newcommand{\vb}{\symbfup{b}}
\newcommand{\vc}{\symbfup{c}}
\newcommand{\vd}{\symbfup{d}}
\newcommand{\ve}{\symbfup{e}}
\newcommand{\vf}{\symbfup{f}}
\newcommand{\vg}{\symbfup{g}}
\newcommand{\vh}{\symbfup{h}}
\newcommand{\vi}{\symbfup{i}}
\newcommand{\vj}{\symbfup{j}}
\newcommand{\vk}{\symbfup{k}}
\newcommand{\vl}{\symbfup{l}}
\newcommand{\vm}{\symbfup{m}}
\newcommand{\vn}{\symbfup{n}}
\newcommand{\vo}{\symbfup{o}}
\newcommand{\vp}{\symbfup{p}}
\newcommand{\vq}{\symbfup{q}}
\newcommand{\vr}{\symbfup{r}}
\newcommand{\vs}{\symbfup{s}}
\newcommand{\vt}{\symbfup{t}}
\newcommand{\vu}{\symbfup{u}}
\newcommand{\vv}{\symbfup{v}}
\newcommand{\vw}{\symbfup{w}}
\newcommand{\vx}{\symbfup{x}}
\newcommand{\vy}{\symbfup{y}}
\newcommand{\vz}{\symbfup{z}}
\newcommand{\valpha}{\symbfup{\alpha}}
\newcommand{\veta}{\symbfup{\eta}}
\newcommand{\vmu}{\symbfup{\mu}}
\newcommand{\vtheta}{\symbfup{\theta}}
\newcommand{\vlambda}{\symbfup{\lambda}}
\newcommand{\vxi}{\symbfup{\xi}}

\newcommand{\rva}{\mathsf{a}}
\newcommand{\rvb}{\mathsf{b}}
\newcommand{\rvc}{\mathsf{c}}
\newcommand{\rvd}{\mathsf{d}}
\newcommand{\rve}{\mathsf{e}}
\newcommand{\rvf}{\mathsf{f}}
\newcommand{\rvg}{\mathsf{g}}
\newcommand{\rvh}{\mathsf{h}}
\newcommand{\rvi}{\mathsf{i}}
\newcommand{\rvj}{\mathsf{j}}
\newcommand{\rvk}{\mathsf{k}}
\newcommand{\rvl}{\mathsf{l}}
\newcommand{\rvm}{\mathsf{m}}
\newcommand{\rvn}{\mathsf{n}}
\newcommand{\rvo}{\mathsf{o}}
\newcommand{\rvp}{\mathsf{p}}
\newcommand{\rvq}{\mathsf{q}}
\newcommand{\rvr}{\mathsf{r}}
\newcommand{\rvs}{\mathsf{s}}
\newcommand{\rvt}{\mathsf{t}}
\newcommand{\rvu}{\mathsf{u}}
\newcommand{\rvv}{\mathsf{v}}
\newcommand{\rvw}{\mathsf{w}}
\newcommand{\rvx}{\mathsf{x}}
\newcommand{\rvy}{\mathsf{y}}
\newcommand{\rvz}{\mathsf{z}}
\newcommand{\rvA}{\mathsf{A}}
\newcommand{\rvB}{\mathsf{B}}
\newcommand{\rvC}{\mathsf{C}}
\newcommand{\rvD}{\mathsf{D}}
\newcommand{\rvE}{\mathsf{E}}
\newcommand{\rvF}{\mathsf{F}}
\newcommand{\rvG}{\mathsf{G}}
\newcommand{\rvH}{\mathsf{H}}
\newcommand{\rvI}{\mathsf{I}}
\newcommand{\rvJ}{\mathsf{J}}
\newcommand{\rvK}{\mathsf{K}}
\newcommand{\rvL}{\mathsf{L}}
\newcommand{\rvM}{\mathsf{M}}
\newcommand{\rvN}{\mathsf{N}}
\newcommand{\rvO}{\mathsf{O}}
\newcommand{\rvP}{\mathsf{P}}
\newcommand{\rvQ}{\mathsf{Q}}
\newcommand{\rvR}{\mathsf{R}}
\newcommand{\rvS}{\mathsf{S}}
\newcommand{\rvT}{\mathsf{T}}
\newcommand{\rvU}{\mathsf{U}}
\newcommand{\rvV}{\mathsf{V}}
\newcommand{\rvW}{\mathsf{W}}
\newcommand{\rvX}{\mathsf{X}}
\newcommand{\rvY}{\mathsf{Y}}
\newcommand{\rvZ}{\mathsf{Z}}
\newcommand{\rveta}{\mathsf{\eta}}
\newcommand{\rvlambda}{\mathsf{\lambda}}

\newcommand{\rvva}{\mathbfsf{a}}
\newcommand{\rvvb}{\mathbfsf{b}}
\newcommand{\rvvc}{\mathbfsf{c}}
\newcommand{\rvvd}{\mathbfsf{d}}
\newcommand{\rvve}{\mathbfsf{e}}
\newcommand{\rvvf}{\mathbfsf{f}}
\newcommand{\rvvg}{\mathbfsf{g}}
\newcommand{\rvvh}{\mathbfsf{h}}
\newcommand{\rvvi}{\mathbfsf{i}}
\newcommand{\rvvj}{\mathbfsf{j}}
\newcommand{\rvvk}{\mathbfsf{k}}
\newcommand{\rvvl}{\mathbfsf{l}}
\newcommand{\rvvm}{\mathbfsf{m}}
\newcommand{\rvvn}{\mathbfsf{n}}
\newcommand{\rvvo}{\mathbfsf{o}}
\newcommand{\rvvp}{\mathbfsf{p}}
\newcommand{\rvvq}{\mathbfsf{q}}
\newcommand{\rvvr}{\mathbfsf{r}}
\newcommand{\rvvs}{\mathbfsf{s}}
\newcommand{\rvvt}{\mathbfsf{t}}
\newcommand{\rvvu}{\mathbfsf{u}}
\newcommand{\rvvv}{\mathbfsf{v}}
\newcommand{\rvvw}{\mathbfsf{w}}
\newcommand{\rvvx}{\mathbfsf{x}}
\newcommand{\rvvy}{\mathbfsf{y}}
\newcommand{\rvvz}{\mathbfsf{z}}
\newcommand{\rvvlambda}{\mathbfsf{\lambda}}
\newcommand{\rvveta}{\mathbfsf{\eta}}

\newcommand{\mA}{\symbfup{A}}
\newcommand{\mB}{\symbfup{B}}
\newcommand{\mC}{\symbfup{C}}
\newcommand{\mD}{\symbfup{D}}
\newcommand{\mE}{\symbfup{E}}
\newcommand{\mF}{\symbfup{F}}
\newcommand{\mG}{\symbfup{G}}
\newcommand{\mH}{\symbfup{H}}
\newcommand{\mI}{\symbfup{I}}
\newcommand{\mJ}{\symbfup{J}}
\newcommand{\mK}{\symbfup{K}}
\newcommand{\mL}{\symbfup{L}}
\newcommand{\mM}{\symbfup{M}}
\newcommand{\mN}{\symbfup{N}}
\newcommand{\mO}{\symbfup{O}}
\newcommand{\mP}{\symbfup{P}}
\newcommand{\mQ}{\symbfup{Q}}
\newcommand{\mR}{\symbfup{R}}
\newcommand{\mS}{\symbfup{S}}
\newcommand{\mT}{\symbfup{T}}
\newcommand{\mU}{\symbfup{U}}
\newcommand{\mV}{\symbfup{V}}
\newcommand{\mW}{\symbfup{W}}
\newcommand{\mX}{\symbfup{X}}
\newcommand{\mY}{\symbfup{Y}}
\newcommand{\mZ}{\symbfup{Z}}
\newcommand{\mSigma}{\symbfup{\Sigma}}

\newcommand{\iprod}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\ind}[1]{\mathds{1}_{#1}}
